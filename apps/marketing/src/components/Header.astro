---
import Branding from './Branding.astro';
import LanguageToggle from './LanguageToggle.astro';
import MenuIcon from './MenuIcon.astro';
import ThemeToggle from './ThemeToggle.astro';

import { useTranslations } from '@/i18n';
import XMarkIcon from './XMarkIcon.astro';

const { t, translatePath } = useTranslations(Astro.url);

const navLinks = [
  {
    href: translatePath('/'),
    label: t('common.overview')
  },
  {
    href: translatePath('/docs'),
    label: t('common.docs')
  },
  {
    href: translatePath('/team'),
    label: t('common.team')
  },
  {
    href: translatePath('/blog'),
    label: t('common.blog')
  }
];
---

<header
  class="fixed top-0 z-10 w-full bg-white/80 text-slate-700 shadow backdrop-blur-lg dark:bg-slate-800/75 dark:text-slate-300"
>
  <div class="container flex items-center justify-between py-3 font-medium">
    <Branding className="[&>span]:hidden [&>span]:lg:block" />
    <div class="hidden shrink md:flex">
      <nav class="flex gap-3 overflow-hidden duration-300" id="nav-dropdown">
        {
          navLinks.map(({ href, label }) => (
            <a class="p-2 dark:text-slate-300 dark:hover:text-slate-100" href={href}>
              {label}
            </a>
          ))
        }
      </nav>
      <div class="mx-5 h-8 w-[1px] rounded-md bg-slate-300 dark:bg-slate-700"></div>
      <div class="flex flex-grow justify-end gap-3">
        <ThemeToggle />
        <LanguageToggle />
      </div>
    </div>
    <button class="flex h-10 items-center md:hidden [&>svg]:h-full [&>svg]:w-auto" id="nav-toggle" type="button">
      <MenuIcon />
    </button>
  </div>
</header>
<div
  class="absolute z-20 bg-black transition-opacity duration-300"
  id="mobile-slider-backdrop"
  style="height: 0px; width: 0px; opacity: 0%;"
>
</div>
<div
  class="absolute right-0 z-30 flex h-screen w-full max-w-[28rem] translate-x-[28rem] flex-col overflow-y-scroll bg-slate-50 py-6 shadow-xl transition-transform duration-300 dark:bg-slate-800"
  id="mobile-slider"
>
  <div class="flex items-center justify-between px-4">
    <div class="px-2">
      <Branding />
    </div>
    <button class="rounded-lg p-2 text-slate-700 transition-colors dark:text-slate-300">
      <XMarkIcon />
    </button>
  </div>
  <hr class="mx-4 my-4 border-slate-300 dark:border-slate-700" />
  {
    navLinks.map(() => (
      <a
        class="flex items-center justify-start p-2 text-slate-900 hover:text-slate-900 dark:text-slate-100 dark:hover:text-slate-100"
        href=""
      />
    ))
  }
</div>

<script>
  const backdrop = document.getElementById('mobile-slider-backdrop')!;
  const slider = document.getElementById('mobile-slider')!;
  const toggle = document.getElementById('nav-toggle')!;

  toggle.addEventListener('click', () => {
    backdrop.style.height = '100vh';
    backdrop.style.width = '100vw';
    backdrop.style.opacity = '50%';

    // backdrop.classList.add('opacity-0');
    // backdrop.classList.add('opacity-50');

    slider.classList.remove('translate-x-[28rem]');
  });
</script>
